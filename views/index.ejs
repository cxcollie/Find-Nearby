<% include partials/header %>

<!-- google map autocomplete -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOBevkDWetQuaXUUlRZFGgkSdYrlDUuhk&libraries=places">
</script>

<script>
function initialize() {
var input = document.getElementById('searchTextField');
var autocomplete = new google.maps.places.Autocomplete(input);
}

google.maps.event.addDomListener(window, 'load', initialize);
</script>

<!-- get current geo-location  -->
<script>
window.onload = getLocation;

function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition, showError);
    } else { 
        document.getElementById("nearby_btn").style.display="none";
    }
}

function showPosition(position) {
    var lat = document.getElementsByName("latitude");
    lat[0].value = position.coords.latitude;
    
    var long = document.getElementsByName("longitude");
    long[0].value = position.coords.longitude;
    
    // set geo tag
    var geo = document.getElementsByName("geo");
    if (geo[0].value == -1) geo[0].value = 0;
}

function showError(error) {
    document.getElementById("nearby_btn").style.display="none";
    switch(error.code) {
        case error.PERMISSION_DENIED:
            //x.innerHTML = "User denied the request for Geolocation."
            break;
        case error.POSITION_UNAVAILABLE:
            //x.innerHTML = "Location information is unavailable."
            break;
    }
}
</script>

<script>
    function Clicked() {
        var geo = document.getElementsByName("geo");
        if (geo[0].value == '0') geo[0].value = '1';
    }
</script>

<div id="home_search"> 
    <h1>Find Nearby Restaurant</h1>
    
    <form id="search_form" action="/restaurants" method="GET" class="form-inline">
        <input type="hidden" name="latitude" placeholder="latitude" value="40.110441">
        <input type="hidden" name="longitude" placeholder="longitude" value="-88.229064">
        <input type="hidden" name="geo" value="-1">
        
      <input type="text" class="form-control" name="restaurant_name" placeholder=" restaurant"> Near
      <input style="min-width: 25em;" id="searchTextField" name="location_name" type="text" class="form-control" placeholder=" i.e. Champaign, IL">
      <button type="submit" class="btn btn-default">Search</button>
      <button onclick="Clicked();" id="nearby_btn" type="submit" class="btn btn-default">Or just Nearby!</button>
    </form>
</form>

</div>


<% include partials/footer %>